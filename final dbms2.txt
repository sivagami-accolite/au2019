1) Display the first name and join date of the employees who joined between 2002 and 2005.

select first_name,join_date from employee where extract(year from join_date) between 2002 and 2005;

2) Display details of departments in which the maximum salary is more than 10000.

select departments.department_id,departments.department_name,departments.manager_id,
departments.location_id from departments inner join employee on departments.department_id = employee.dept_id inner join jobs on employee.jobid=jobs.job_id where jobs.max_salary>10000;

3) Display city, departments, number of employee in each department.
select departments.department_id as Dept_Id,departments.department_name as Dept_Name,dept_emp.EmpCount as Employee_Count,locations.city from dept_emp join departments on  departments.department_id=dept_emp.dept_id join locations on locations.location_id=departments.location_id;

4) Display Departments where there are more then 5 employees.
select departments.department_name as Dept_Name,departments.department_id as Dept_Id from departments join dept_emp on departments.department_id=dept_emp.dept_id where dept_emp.EmpCount>5;

5) Create two tables - Color (Color_id,Color_Name) populate it with 5-6 color data
                       Sizes (Size_code,Description) e.g.('M',Medium) populate table with sizes XS,S,M,L,XL,XXL.
   Q) Write Query to Display all possible combinations of color and size.
select a.colorname,  b.sizecode from color as a cross join size as b; 

6) Create a table  Cricket_Match with following columns and populate it with data given. 
-------------------------------------
       Match Player Score
-------------------------------------	
        1      A      0
	1      B      101
	1      C      55
	1      D      23
	1      E      12
	1      F      100
	2      A      146
	2      B      120
	2      C      104
	2      D      3
	2      E      54
	2      F      111
------------------------------------

  Q) Write query to display players who have scored century in both the games.
  Q) Write query to display players who have scored century in match 1 OR match 2 but not in both.

select player from Cricket_Match where (score>=100 and matchid=1) and player in (select player from Cricket_Match where (score>=100 and matchid=2));

select player from Cricket_Match where (score>=100 and matchid=1) and player not in (select player from Cricket_Match where (score>=100 and matchid=2)) union select player from Cricket_Match where (score>=100 and matchid=2) and player not in (select player from Cricket_Match where (score>=100 and matchid=1));

7)  Create a table friend_list(Name, Friend_Name)
Populate it with following data:
        ------------------ 
	Name | Friend_Name 
        ------------------
	Sam      Ram
	Sam      Vamsi
	Vamsi    Ram
	Vamsi    Jhon
	Ram      Vijay
	Ram      Anand

write a query to find friends of friends of sam.

select  f1.name, f2.friend_name as friend_of_friend_of_Sam from friend_list f1,friend_list f2 where f1.name = 'Sam' and f1.friend_name = f2.name;

8) Create a function to calculate new salary of an employee from hr.employees table by a certain percentage.
   Two IN parameters (Employee_id,Hike_pct) 
   One OUT parameter (New_Salary) 

delimiter $$
create procedure getNewSalary(IN empId int,IN hike int,OUT sal float)
BEGIN
	declare curSalary int;
    select salary into curSalary from employee where employee_id=empId;
    select (curSalary+((hike*curSalary)/100)) into sal;
END$$

call getNewSalary(11,10,@new_sal);
select @new_sal as New_Salary;

9) Create a stored procedure to update the salary of an employee by 13% in hr.employees table.
   One IN parameter - emp_id 
   *** Use the function created in previous question to calculate new salary. 
  
delimiter $$
create procedure updateSal(IN empId int)
BEGIN
	call getNewSalary(empId,13,@new_sal);
	update employee set salary=@new_sal where employee_id=empId;
END$$